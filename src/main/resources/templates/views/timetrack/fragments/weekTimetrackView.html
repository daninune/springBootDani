<div th:fragment="weekView">


    <div id="calendarTimeTracking" style="padding-bottom: 20px; border-bottom: 1px solid lightgrey;"></div>
    <!-- Week Selector -->
    <div class="row d-flex justify-content-center">
        <div class="col d-flex justify-content-center"><b>SEMANA</b></div>
    </div>

    <!--  <?php if ($dutyWeekArray[0]->getDateEnd() == $dayArray[6]) : ?>-->
    <div class="col d-flex justify-content-center">(Guardia)</div>
    <!--<?php endif; ?>-->

    <div class="row d-flex justify-content-center">
        <div class="col-2 d-flex justify-content-end">
            <a href="#" onClick="getTimeTracking('valor','valor')">
                <svg class="bi bi-caret-left-fill" fill="black" height="16" viewBox="0 0 16 16"
                     width="16" xmlns="http://www.w3.org/2000/svg">
                    <path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"/>
                </svg>
            </a>
        </div>

        <div class="col d-flex justify-content-center">(valor - valor)</div>

        <div class="col-2 d-flex justify-content-start">
            <a href="#" onClick="getTimeTracking('valor','valor')">
                <svg class="bi bi-caret-right-fill" fill="black" height="16" viewBox="0 0 16 16"
                     width="16" xmlns="http://www.w3.org/2000/svg">
                    <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
                </svg>
            </a>
        </div>
    </div>

    <!-- Total Time -->
    <!--<?php

    if (count($timeTrackArray) >= 1 && $timeTrackArray[0]->getId() != 0) {-->

    <div class='card' style='vertical-align: middle; margin-left: auto; margin-right: auto; width: 420px;'>
        <div class='card-body' style='text-align: center;'><b>Horas Ordinarias</b>: " .
            $totalTimeArray['totalOrdinaryTime'] . " &nbsp; | &nbsp; <b>Horas Extras</b>: " .
            $totalTimeArray['totalExtraTime'] . "
        </div>
    </div>


    <!-- Week Table -->
    <div style="margin: 0% 2%;">

        <!--<?php
          $daysArray = array();
          foreach ($timeTrackArray as $row) {
              // If there is no entries
              if ($row->getId() == 0) {
        //cargamos los datos de la semana anterior
        $previousWeek = $this->Timetrack_model->getTimeTrackingWeekDataDB($timeTrackArray[0]->getIdemployee(), $p4prev);
        //si la semana anterior no está vacía y el usuario es idrol 2, mostramos el botón de replicar semana anterior
        ?>
        <?php if ($previousWeek[0]->getId() != 0 && $_SESSION['idRol'] == 2) : ?>-->
        <div class='row d-flex justify-content-center'>
            <div class='col d-flex justify-content-center'>
                <button class='btn btn-outline-primary' style='width: 210px;' type='button'>Replicar semana
                    anterior
                </button>
                <!--        TODO boton enlace-->
                <!--        <button type='button' class='btn btn-outline-primary' style='width: 210px;' onclick='replicatePrevWeek(<?php echo json_encode($previousWeek); ?>)'>Replicar semana anterior</button>-->
            </div>
        </div>
        <!--<?php endif; ?>
        <?php-->

        <div class='card' style='vertical-align: middle; margin-left: auto; margin-right: auto; width: 350px;'>
            <div class='card-body' style='text-align: center;'>No hay ningún registro en esta semana</div>
        </div>

        <!-- // If there is entries
         } else {
         $isOnDuty = false;
         foreach ($dutyWeekArray as $duty) {
         if ($duty->getDateEnd() == $row->getDate()) {
         $isOnDuty = true;
         }
         }
         $extraHour;
         if ($row->getisExtra() == 1) {
         $extraHour = "Si";
         } else {
         $extraHour = "No";
         }
         $ubication;
         if ($row->getUbication() == 0) {
         $ubication = "Oficina";
         } else if ($row->getUbication() == 1) {
         $ubication = "Teletrabajo";
         } else {
         $ubication = "Cliente";
         }


         $projectName = $ProjectsNamesArray[$row->getProjectID()];

         // If is a common project
         foreach ($projectIsCommon as $common) {
         if ($common->getIdProject() == $row->getProjectID()) {
         $projectName = $common->getProjectName();
         }
         }


         $day = $row->getDate();
         if (in_array($day, $daysArray)) {
         echo-->

        <!--   <script type='text/javascript'>

           addNewRow('" . $row->getId() . "', '" . $row->getDate() . "', '" . $row->getDescription() . "', '" . $projectName . "', '" . $row->getTimeInit() . "', '" . $row->getTimeEnd() . "', '" . $ubication . "', '" . $extraHour . "', '" . $timeTrackArray[0]->getIdemployee() . "', " . false . ");

         </script>-->
        <!--} else {

        array_push($daysArray, $row->getDate());

        if ($isOnDuty) {-->

        <!--echo "<span><h4 style='display: inline; margin-bottom: 0rem;'>" . date("d-m-Y", strtotime($row->getDate())) . "</h4> (Guardia)</span>";
        } else {

        echo "<h4 style='margin-bottom: 0rem;'>" . date("d-m-Y", strtotime($row->getDate())) . "</h4>";
        }-->

        <table class='table' id='" . $row->getDate() . "' style='margin-top: 0.5rem;'>
            <thead align='center' class='table-light'>
            <tr>
                <th width='25%'>Descripción</th>
                <th width='15%'>Proyecto</th>
                <th width='20%'>Tiempo</th>
                <th width='15%'>Lugar</th>
                <th width='15%'>Hora Extra</th>
                <th colspan=2 width='10%'>Opciones</th>
            </tr>
            </thead>
            <tbody align='center' th:each="timetrack : ${timetracks}">
            <tr>
                <td th:text="${timetrack.description}" width='25%'></td>
                <td th:text="${timetrack.projectName}" width='15%'></td>
                <td th:text="${timetrack.timeInit} - ${user.timeEnd}" width='20%'></td>
                <td th:text="${timetrack.ubication}" width='15%'></td>
                <td th:text="${timetrack.extraHour}" width='10%'></td>

                <td width='5%'><a id='edit'
                                  onclick='editEntry("${timetrack.id}","${timetrack.date}","${timetrack.description}","${timetrack.projectName}","${timetrack.timeInit}","${timetrack.timeEnd}","${timetrack.ubication}","${timetrack.extraHour}")'
                                  style='cursor: pointer;'>
                    <svg class="bi bi-pencil" fill="currentColor" height="16" viewBox="0 0 16 16"
                         width="16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
                    </svg>
                </a></td>
                <td width='5%'><a id='edit01' style='cursor: pointer;'>
                    <svg class="bi bi-pencil" fill="currentColor" height="16" viewBox="0 0 16 16"
                         width="16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
                    </svg>
                </a></td>
                <td width='5%'><a id='edit02' style='cursor: pointer;'>
                    <svg class="bi bi-pencil" fill="currentColor" height="16" viewBox="0 0 16 16"
                         width="16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
                    </svg>
                </a></td>
                <td width='5%'><a id='delete' style='cursor: pointer;'>
                    <svg class="bi bi-trash3" fill="currentColor" height="16" viewBox="0 0 16 16"
                         width="16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                    </svg>
                </a></td>
                <!--      TODO enlace-->
                <!--      <td width='5%'><a id='delete' style='cursor: pointer;' onclick='deleteEntry(\"" . $row->getId() . "\",\"" . $row->getDate() . "\",\"" . $timeTrackArray[0]->getIdemployee() . "\",\"" . date("y-m-d") . "\")'><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">-->
                <!--        <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>-->
                <!--      </svg></a></td>-->
            </tr>
            </tbody>
        </table>
    </div>


    <!-- Inform Button -->
    <div class="row d-flex justify-content-center">
        <div class="col d-flex justify-content-center">
            <button class="btn btn-outline-primary" type="button">Informe</button>
            <!--      TODO onclick-->
            <!--      <button type="button" class="btn btn-outline-primary" onclick="showTimeTrackingCalendar(<?= $monday ?>, <?= $timeTrackArray[0]->getIdEmployee() ?>);">Informe</button>-->
        </div>

        <div class="col d-flex justify-content-center">
            <!--      <button type="button" class="btn btn-outline-primary" th:onclick="test('[id]')">test01</button>-->
            <!--      <button type="button" class="btn btn-outline-primary" th:onclick="'test('${today}');'">test02</button>-->
            <button class="btn btn-outline-primary" th:attr="onclick=|test('${today}')|" type="button">test04
            </button>
            <!--      <button type="button" class="btn btn-outline-primary" th:onclick="test('document.getElementById(\'date\').value')" >test05</button>-->
            <!--      <button type="button" class="btn btn-outline-primary" th:attr="onclick=${'test('''+${today}+''')'}">test03</button>-->
        </div>
    </div>


    <!-- Edit Entry - Modal Window -->
    <div class="modal fade" id="entry-modal">

        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Modificar Registro</h4>
                    <button class="close" data-bs-dismiss="modal" type="button"><span
                            aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                </div>

                <div class="modal-body">
                    <input id="entryId" type="hidden">
                    <form class="form-horizontal">

                        <div class="form-group">
                            <label class="col control-label">Descripción</label>
                            <div class="col">
                                <input class="form-control" id="descriptionModal" name="description"
                                       placeholder="En qué estuviste trabajando?"
                                       type="text">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col control-label">Proyecto</label>
                            <div class="col">
                                <select class="form-select" id="idProjectModal" name="idProject">
                                    <!--                  TODO onchange-->
                                    <!--                <select class="form-select" id="idProjectModal" name="idProject" onchange='checkIsComputable(<?= json_encode($allProjects) ?>, 1)'>-->
                                    <option value="null">-- Elige un proyecto --</option>
                                    <!--<?php
                                                    if (count($projectEmployees) >= 1) {
                                    if ($projectEmployees[0]->getIdProject() != 0) {
                                    echo '<optgroup label="Asociados">';
                                    foreach ($projectEmployees as $row) {
                                    if ($row->getIsCommon() == 0) {
                                    echo '<option value ="' . $row->getIdProject() . '">' . $row->getProjectName() . '</option>';
                                    }
                                    }
                                    }
                                    }

                                    if (count($projectIsCommon) >= 1) {
                                    if ($projectIsCommon[0]->getIdProject() != 0) {
                                    echo '<optgroup label="Comunes">';
                                      foreach ($projectIsCommon as $row) {
                                      if ($row->getIsCommon() == 1) {
                                      echo '<option value ="' . $row->getIdProject() . '">' . $row->getProjectName() . '</option>';
                                      }
                                      }
                                      }
                                      }

                                      ?>-->

                                </select>
                            </div>
                        </div>

                        <input id="dateModal" name="date" type="hidden">

                        <div class="row g-3" style="padding-left: 15px; padding-right: 15px; margin-bottom: 15px;">
                            <div class="col-md-6" id="timeInitContainerModal">
                                <label class="control-label">Hora inicio</label>
                                <div class="input-group clockPicker" data-autoclose="true">
                                    <div class="input-group-text">
                                        <svg class="bi bi-hourglass-top" fill="currentColor" height="16"
                                             viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M2 14.5a.5.5 0 0 0 .5.5h11a.5.5 0 1 0 0-1h-1v-1a4.5 4.5 0 0 0-2.557-4.06c-.29-.139-.443-.377-.443-.59v-.7c0-.213.154-.451.443-.59A4.5 4.5 0 0 0 12.5 3V2h1a.5.5 0 0 0 0-1h-11a.5.5 0 0 0 0 1h1v1a4.5 4.5 0 0 0 2.557 4.06c.29.139.443.377.443.59v.7c0 .213-.154.451-.443.59A4.5 4.5 0 0 0 3.5 13v1h-1a.5.5 0 0 0-.5.5zm2.5-.5v-1a3.5 3.5 0 0 1 1.989-3.158c.533-.256 1.011-.79 1.011-1.491v-.702s.18.101.5.101.5-.1.5-.1v.7c0 .701.478 1.236 1.011 1.492A3.5 3.5 0 0 1 11.5 13v1h-7z"/>
                                        </svg>
                                    </div>
                                    <input class="form-control" id="timeInitModal" name="timeInit"
                                           placeholder="Hora inicio..."
                                           style="background-color: white;" type="text">
                                </div>
                            </div>

                            <div class="col-md-6" id="timeEndContainerModal">
                                <label class="control-label">Hora fin</label>
                                <div class="input-group clockPicker" data-autoclose="true">
                                    <div class="input-group-text">
                                        <svg class="bi bi-hourglass-bottom" fill="currentColor" height="16"
                                             viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M2 1.5a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-1v1a4.5 4.5 0 0 1-2.557 4.06c-.29.139-.443.377-.443.59v.7c0 .213.154.451.443.59A4.5 4.5 0 0 1 12.5 13v1h1a.5.5 0 0 1 0 1h-11a.5.5 0 1 1 0-1h1v-1a4.5 4.5 0 0 1 2.557-4.06c.29-.139.443-.377.443-.59v-.7c0-.213-.154-.451-.443-.59A4.5 4.5 0 0 1 3.5 3V2h-1a.5.5 0 0 1-.5-.5zm2.5.5v1a3.5 3.5 0 0 0 1.989 3.158c.533.256 1.011.791 1.011 1.491v.702s.18.149.5.149.5-.15.5-.15v-.7c0-.701.478-1.236 1.011-1.492A3.5 3.5 0 0 0 11.5 3V2h-7z"/>
                                        </svg>
                                    </div>
                                    <input class="form-control" id="timeEndModal" name="timeEnd"
                                           placeholder="Hora fin..."
                                           style="background-color: white;" type=" text">
                                </div>
                            </div>
                        </div>

                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="col control-label">Lugar</label>
                                <div class="col">
                                    <div class="form-check" style="margin-left: 10px;">
                                        <input checked class="form-check-input" id="officeModal"
                                               name="ubicationOptionsModal" type="radio" value="0">
                                        <label class="form-check-label" for="officeModal">
                                            Oficina
                                        </label>
                                    </div>
                                    <div class="form-check" style="margin-left: 10px;">
                                        <input class="form-check-input" id="remoteModal"
                                               name="ubicationOptionsModal"
                                               type="radio" value="1">
                                        <label class="form-check-label" for="remoteModal">
                                            Teletrabajo
                                        </label>
                                    </div>
                                    <div class="form-check" style="margin-left: 10px;">
                                        <input class="form-check-input" id="customerModal"
                                               name="ubicationOptionsModal"
                                               type="radio" value="2">
                                        <label class="form-check-label" for="customerModal">
                                            Cliente
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6" id="extraHoursContainerModal">
                                <label class="col control-label">Horas Extra</label>
                                <div class="col">
                                    <div class="form-check" style="margin-left: 10px;">
                                        <input class="form-check-input" id="isExtraModal" name="extraHoursModal"
                                               type="radio" value="1">
                                        <label class="form-check-label" for="isExtraModal">
                                            Si
                                        </label>
                                    </div>
                                    <div class="form-check" style="margin-left: 10px;">
                                        <input checked class="form-check-input" id="isNotExtraModal"
                                               name="extraHoursModal" type="radio" value="0">
                                        <label class="form-check-label" for="isNotExtraModal">
                                            No
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-outline-primary"
                            onclick="saveTracking(document.getElementById('entryId').value,valor);"
                            type="button">OK
                    </button>
                    <button class="btn btn-outline-default" data-bs-dismiss="modal" type="button">Cancelar</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Duty - Modal Window -->
    <div class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" id="duty-modal">
        <div class="modal-dialog modal-dialog-centered" style="max-width: 620px;">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Guardias</h4>
                    <button class="close" data-bs-dismiss="modal" type="button">
                        <span aria-hidden="true">×</span>
                        <span class="sr-only">Close</span>
                    </button>
                </div>

                <div class="modal-body">
                    <div id="timetrackDutyDiv"></div>
                </div>
            </div>
        </div>


        <!-- JavaScript Functions -->
        <!--   <script src='js/timetrack.js'></script>
           <script src='js/timetrackFunctions.js'></script>
           <script src='js/dutyFunctions.js'></script>
           <script>
             $(".clockPicker").clockpicker();
           </script>-->
    </div>

</div>